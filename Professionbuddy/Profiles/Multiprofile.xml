<?xml version="1.0" encoding="utf-8"?>
<Professionbuddy>
  <!--ATTENTION: READ BELOW BEFORE YOU START-->
  <!--Set Hearth to Dwarf area in Stormwind if Alliance or Org if horde-->
  <!--Adjust the profile settings especially your banker and farmer name -->
  <!--if changes are made to settings after profile was running you might need to restart HB (press stop then start)-->
  <!--You must start HB while logged in your farmer-->
  <!--If you customize this profile (change profiles, AH buyout etc) remember to rename so it doesn't get overwritten when you update from svn-->
  <!--********** Credits **********-->
  <!--Extacy -  For help with the Org portals-->
  <!--no1knowsy -  For help with the Org portals-->
  <!--imdasandman - For help with the Org portals-->
  <!--Thumped - For help with the Org portals-->
  <SubRoutine SubRoutineName="Do Not Edit these settings directly!!, Use the 'Settings' Tab instead">
    <Settings Type="UInt32" DefaultValue="0" Name="FarmedZone" Summary="Do Not Edit" Category="Misc" />
    <Settings Type="String" DefaultValue="" Name="BankerName" Summary="The Name of your banker" Category="Banker" />
    <Settings Type="String" DefaultValue="" Name="FarmerName" Summary="The Name of your Farmer" Category="Farmer" />
    <Settings Type="Boolean" DefaultValue="true" Name="Hyjal" Summary="Farm in Hyjal " Category="Zones" />
    <Settings Type="Boolean" DefaultValue="true" Name="Twilight" Summary="Farm in Twilight Highlands" Category="Zones" />
    <Settings Type="Boolean" DefaultValue="true" Name="Uldum" Summary="Farm in Uldum" Category="Zones" />
    <Settings Type="Boolean" DefaultValue="false" Name="Deepholm" Summary="Farm in Deepholm" Category="Zones" />
    <Settings Type="Boolean" DefaultValue="false" Name="EmptyBagsNow" Summary="Set to true to empty bags now." Category="Farmer" />
    <Settings Type="Boolean" DefaultValue="true" Name="SwitchToBanker" Summary="Set this to true if you want to switch to banker to AH items." Category="Banker" />
    <Settings Type="Int32" DefaultValue="200" Name="DepositAllButThisAmountInGBank" Summary="Deposits all gold except this amount." Category="Banker" />
    <Settings Type="Boolean" DefaultValue="false" Name="DepositGoldInGbank" Summary="Set to true if you want to banker to depost gold in gbank" Category="Banker" />
    <Settings Type="Boolean" DefaultValue="true" Name="EnableZoneTimer" Summary="Set to true to leave zone after random amount of time spent there." Category="Farmer" />
    <Settings Type="Int32" DefaultValue="120" Name="MinMinutesPerZone" Summary="Minimum number of minutes to spend in a zone" Category="Farmer" />
    <Settings Type="Int32" DefaultValue="240" Name="MaxMinutesPerZone" Summary="Max number of minutes to spend in a zone" Category="Farmer" />
    <Settings Type="Boolean" DefaultValue="false" Name="RandomZones" Summary="Randomly choose next zone with current zone being excluded." Category="Farmer" />
    <Settings Type="Boolean" DefaultValue="true" Name="DeleteLifegivingSeeds" Summary="will automatically delete any lifegiving seeds" Category="Farmer" />
    <Settings Type="Boolean" DefaultValue="false" Name="DepositInGbank" Summary="deposits items in Gbank instead of mailing them to banker" Category="Farmer" />
  </SubRoutine>
  <CallSubRoutine SubRoutineName="Init" />
  <CallSubRoutine SubRoutineName="LoadProfile" />
  <If Condition="Me.Name.Equals((string)Settings[&quot;BankerName&quot;],StringComparison.InvariantCultureIgnoreCase) " IgnoreCanRun="True">
    <CustomAction Code="MessageBox.Show(&quot;Switch to your farmer before starting this multiprofile. Must restart HB&quot;);TreeRoot.Stop();" />
  </If>
  <!--Check if GB is current bot and only when farmer is logged on.-->
  <If Condition="(bool)var2 &amp;&amp; SecondaryBot.Name != &quot;Gatherbuddy2&quot;" IgnoreCanRun="True">
    <CustomAction Code="SwitchToBot(&quot;Gatherbuddy2&quot;);" />
    <WaitAction Condition="SecondaryBot.Name == &quot;Gatherbuddy2&quot;" Timeout="20000" />
  </If>
  <While Condition="true" IgnoreCanRun="True">
    <If Condition="(bool)Settings[&quot;DeleteLifegivingSeeds&quot;] &amp;&amp; InbagCount(63122) &gt; 0" IgnoreCanRun="True">
      <CustomAction Code="Lua.DoString(&quot;for bag = 0,4 do for slot=1,GetContainerNumSlots(bag) do local id = GetContainerItemID(bag,slot) or 0 if id == 63122 then PickupContainerItem(bag,slot) DeleteCursorItem() end end end&quot;);" />
    </If>
    <!--Check if bags are full and not in city. If true then hearth-->
    <If Condition="Me.FreeNormalBagSlots &lt;=4 &amp;&amp; Me.ZoneId != (int)var3" IgnoreCanRun="False">
      <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Hearthing because I have only {0} free bags slots&quot;,Me.FreeNormalBagSlots);" />
      <CallSubRoutine SubRoutineName="Hearth" />
    </If>
    <If Condition="(bool)Settings[&quot;EmptyBagsNow&quot;] &amp;&amp; Me.ZoneId != (int)var3" IgnoreCanRun="False">
      <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Hearthing because you forced me to&quot;);" />
      <CallSubRoutine SubRoutineName="Hearth" />
    </If>
    <If Condition="((bool)Settings[&quot;EnableZoneTimer&quot;] &amp;&amp; DateTime.Now.Subtract((DateTime)var7).TotalMinutes &gt;= (int)var6 ) &amp;&amp; Me.ZoneId != (int)var3" IgnoreCanRun="True">
      <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Hearthing out of are because I was in zone for {0} minutes&quot;,var6);" />
      <CustomAction Code="Settings[&quot;EmptyBagsNow&quot;] = true;" />
    </If>
    <!--Check if bags are full and not in city. If true then hearth-->
    <!--Check if we're in factions capital city. Stormwind = 1519. Org = 1637-->
    <If Condition="Me.ZoneId == (int)var3 &amp;&amp; (bool)var2" IgnoreCanRun="True">
      <!--On Farmer-->
      <If Condition="(bool)var2" IgnoreCanRun="True">
        <If Condition="Me.FreeNormalBagSlots &lt;=4 || (bool)Settings[&quot;EmptyBagsNow&quot;]" IgnoreCanRun="True">
          <If Condition="(bool)Settings[&quot;DepositInGbank&quot;]" IgnoreCanRun="True">
            <CallSubRoutine SubRoutineName="StoreItemsInGbank" />
            <If Condition="(bool)Settings[&quot;EmptyBagsNow&quot;]" IgnoreCanRun="True">
              <CustomAction Code="Settings[&quot;EmptyBagsNow&quot;] = false;" />
            </If>
          </If>
          <If Condition="!(bool)Settings[&quot;DepositInGbank&quot;]" IgnoreCanRun="True">
            <CallSubRoutine SubRoutineName="MailItems" />
            <CustomAction Code="Log (Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Switching to banker&quot;);" />
            <!--Log on Banker-->
            <If Condition="(bool)Settings[&quot;SwitchToBanker&quot;]" IgnoreCanRun="True">
              <CustomAction Code="SwitchCharacter((string)Settings[&quot;BankerName&quot;],(string) var1,&quot;Combat Bot&quot;);" />
              <WaitAction Condition="!StyxWoW.IsInWorld" Timeout="20000" />
            </If>
            <If Condition="!(bool)Settings[&quot;SwitchToBanker&quot;] &amp;&amp; (bool)Settings[&quot;EmptyBagsNow&quot;]" IgnoreCanRun="True">
              <CustomAction Code="Settings[&quot;EmptyBagsNow&quot;] = false;" />
            </If>
          </If>
        </If>
        <!--Change FarmedZone to the next zone-->
        <If Condition="!(bool)Settings[&quot;RandomZones&quot;]" IgnoreCanRun="True">
          <CustomAction Code="uint a = ((List&lt;uint&gt;)var4).FirstOrDefault(zone =&gt; zone &gt; (uint)Settings[&quot;FarmedZone&quot;]); Settings[&quot;FarmedZone&quot;] = a &gt; 0u? a: ((List&lt;uint&gt;)var4).Min();" />
        </If>
        <If Condition="(bool)Settings[&quot;RandomZones&quot;]" IgnoreCanRun="True">
          <CustomAction Code="int nextZoneI = 0;if (((List&lt;uint&gt;)var4).Count &gt; 1) {Random r = new Random(); int index = ((List&lt;uint&gt;)var4).IndexOf((uint)Settings[&quot;FarmedZone&quot;]);do{nextZoneI=r.Next(0, ((List&lt;uint&gt;)var4).Count) ;}while ( nextZoneI== index);} Settings[&quot;FarmedZone&quot;] =  ((List&lt;uint&gt;)var4)[nextZoneI];" />
        </If>
        <CallSubRoutine SubRoutineName="LoadProfile" />
        <CallSubRoutine SubRoutineName="Use Portal" />
        <If Condition="(bool)Settings[&quot;EnableZoneTimer&quot;]" IgnoreCanRun="True">
          <CustomAction Code="var6 = new Random().Next((int)Settings[&quot;MinMinutesPerZone&quot;],(int)Settings[&quot;MaxMinutesPerZone&quot;]);" />
          <CustomAction Code="Log( Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;I will spend {0} minutes in this zone&quot;,var6);" />
        </If>
      </If>
    </If>
    <!--On Banker-->
    <If Condition="!(bool)var2" IgnoreCanRun="False">
      <!--Get all mail and put it on AH-->
      <While Condition="HasNewMail || MailCount&gt; 0" IgnoreCanRun="True">
        <GetMailAction ItemID="" CheckNewMail="True" GetMailType="AllItems" AutoFindMailBox="True" X="0" Y="0" Z="0" MinFreeBagSlots="2" />
        <CallSubRoutine SubRoutineName="SellOnAH" />
      </While>
      <If Condition="(bool)Settings[&quot;EmptyBagsNow&quot;]" IgnoreCanRun="True">
        <CustomAction Code="Settings[&quot;EmptyBagsNow&quot;] = false;" />
      </If>
      <If Condition="(bool)Settings[&quot;DepositGoldInGbank&quot;] &amp;&amp; (int)Me.Gold &gt; (int)Settings[&quot;DepositAllButThisAmountInGBank&quot;]" IgnoreCanRun="True">
        <CallSubRoutine SubRoutineName="DepositGoldInGbank" />
      </If>
      <CustomAction Code="Log (Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Switching back to farmer&quot;);" />
      <!--Log on Farmer-->
      <CustomAction Code="SwitchCharacter((string)Settings[&quot;FarmerName&quot;],(string) var1,&quot;Gatherbuddy2&quot;);" />
      <WaitAction Condition="!StyxWoW.IsInWorld" Timeout="20000" />
    </If>
  </While>
  <SubRoutine SubRoutineName="MailItems">
    <MailItemAction Entry="" AutoFindMailBox="True" UseCategory="True" Category="TradeGoods" SubCategoryType="WoWItemTradeGoodsClass" SubCategory="None" X="0" Y="0" Z="0" />
    <MailItemAction Entry="" AutoFindMailBox="True" UseCategory="True" Category="Gem" SubCategoryType="WoWItemGemClass" SubCategory="None" X="0" Y="0" Z="0" />
  </SubRoutine>
  <SubRoutine SubRoutineName="StoreItemsInGbank">
    <CallSubRoutine SubRoutineName="MoveToGbank" />
    <CustomAction Code="Log( Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Storing items in GBank&quot;);" />
    <PutItemInBankAction Amount="0" ItemID="" NpcEntry="0" GuildTab="0" AutoFindBank="True" UseCategory="True" Category="TradeGoods" SubCategoryType="WoWItemTradeGoodsClass" SubCategory="None" Bank="Guild" X="0" Y="0" Z="0" />
    <PutItemInBankAction Amount="0" ItemID="" NpcEntry="0" GuildTab="0" AutoFindBank="True" UseCategory="True" Category="Gem" SubCategoryType="WoWItemGemClass" SubCategory="None" Bank="Guild" X="0" Y="0" Z="0" />
  </SubRoutine>
  <SubRoutine SubRoutineName="SellOnAH">
    <SellItemOnAhAction ItemID="0" MinBuyout="0g10s0c" MaxBuyout="12g0s0c" RunTime="_24_Hours" Amount="10" StackSize="20" IgnoreStackSizeBelow="5" AmountType="Everything" AutoFindAh="True" BidPrecent="95" UndercutPrecent="0.0001" UseCategory="True" Category="TradeGoods" SubCategoryType="WoWItemTradeGoodsClass" SubCategory="MetalStone" X="0" Y="0" Z="0" PostIfBelowMinBuyout="True" />
    <SellItemOnAhAction ItemID="0" MinBuyout="5g50s0c" MaxBuyout="20g0s0c" RunTime="_24_Hours" Amount="10" StackSize="20" IgnoreStackSizeBelow="5" AmountType="Everything" AutoFindAh="True" BidPrecent="95" UndercutPrecent="0.0001" UseCategory="True" Category="TradeGoods" SubCategoryType="WoWItemTradeGoodsClass" SubCategory="Elemental" X="0" Y="0" Z="0" PostIfBelowMinBuyout="True" />
    <SellItemOnAhAction ItemID="0" MinBuyout="0g10s0c" MaxBuyout="6g0s0c" RunTime="_24_Hours" Amount="10" StackSize="20" IgnoreStackSizeBelow="5" AmountType="Everything" AutoFindAh="True" BidPrecent="95" UndercutPrecent="0.0001" UseCategory="True" Category="TradeGoods" SubCategoryType="WoWItemTradeGoodsClass" SubCategory="Herb" X="0" Y="0" Z="0" PostIfBelowMinBuyout="True" />
    <SellItemOnAhAction ItemID="0" MinBuyout="0g10s0c" MaxBuyout="200g0s0c" RunTime="_24_Hours" Amount="10" StackSize="20" IgnoreStackSizeBelow="5" AmountType="Everything" AutoFindAh="True" BidPrecent="95" UndercutPrecent="0.0001" UseCategory="True" Category="TradeGoods" SubCategoryType="WoWItemTradeGoodsClass" SubCategory="Cloth" X="0" Y="0" Z="0" PostIfBelowMinBuyout="True" />
    <SellItemOnAhAction ItemID="0" MinBuyout="0g10s0c" MaxBuyout="200g0s0c" RunTime="_24_Hours" Amount="10" StackSize="20" IgnoreStackSizeBelow="1" AmountType="Everything" AutoFindAh="True" BidPrecent="95" UndercutPrecent="0.0001" UseCategory="True" Category="Gem" SubCategoryType="WoWItemGemClass" SubCategory="None" X="0" Y="0" Z="0" PostIfBelowMinBuyout="True" />
    <SellItemOnAhAction ItemID="0" MinBuyout="0g10s0c" MaxBuyout="100g0s0c" RunTime="_24_Hours" Amount="10" StackSize="20" IgnoreStackSizeBelow="1" AmountType="Everything" AutoFindAh="True" BidPrecent="95" UndercutPrecent="0.0001" UseCategory="True" Category="Armor" SubCategoryType="WoWItemArmorClass" SubCategory="Misc" X="0" Y="0" Z="0" PostIfBelowMinBuyout="True" />
    <SellItemOnAhAction ItemID="0" MinBuyout="5g50s0c" MaxBuyout="20g0s0c" RunTime="_24_Hours" Amount="10" StackSize="20" IgnoreStackSizeBelow="5" AmountType="Everything" AutoFindAh="True" BidPrecent="95" UndercutPrecent="0.0001" UseCategory="True" Category="TradeGoods" SubCategoryType="WoWItemTradeGoodsClass" SubCategory="Elemental" X="0" Y="0" Z="0" PostIfBelowMinBuyout="True" />
  </SubRoutine>
  <SubRoutine SubRoutineName="Hearth">
    <!--Dismount and use hearthstone-->
    <If Condition="!Me.IsCasting" IgnoreCanRun="True">
      <CustomAction Code="Mount.Dismount();" />
      <CustomAction Code="Lua.DoString(&quot;UseItemByName(6948)&quot;);" />
      <WaitAction Condition="Me.IsCasting" Timeout="2000" />
    </If>
    <WaitAction Condition="!Me.IsCasting" Timeout="10000" />
  </SubRoutine>
  <SubRoutine SubRoutineName="Init">
    <CustomAction Code="Log(Color.GreenYellow,&quot;&quot;,Color.GreenYellow,&quot;*************** Settings ****************&quot;);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;SwitchToBanker: {0}&quot;,Settings[&quot;SwitchToBanker&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;DepositGoldInGbank: {0}&quot;,Settings[&quot;DepositGoldInGbank&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;MinMinutesPerZone: {0}&quot;,Settings[&quot;MinMinutesPerZone&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;MaxMinutesPerZone: {0}&quot;,Settings[&quot;MaxMinutesPerZone&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;RandomZones: {0}&quot;,Settings[&quot;RandomZones&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;DeleteLifegivingSeeds: {0}&quot;,Settings[&quot;DeleteLifegivingSeeds&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;DepositInGbank: {0}&quot;,Settings[&quot;DepositInGbank&quot;]);" />
    <CustomAction Code="Log(Color.GreenYellow,&quot;&quot;,Color.GreenYellow,&quot;***************** Zones *****************&quot;);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;Hyjal: {0}&quot;,Settings[&quot;Hyjal&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;Twilight: {0}&quot;,Settings[&quot;Twilight&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;Uldum: {0}&quot;,Settings[&quot;Uldum&quot;]);" />
    <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;Deepholm: {0}&quot;,Settings[&quot;Deepholm&quot;]);" />
    <!--store current server name, needed when switching characters.-->
    <CustomAction Code="var1 = Lua.GetReturnVal&lt;string&gt;(&quot;return GetRealmName()&quot;,0);" />
    <!--set to 'true' if on farmer, otherwise if on banker then it's set to false-->
    <CustomAction Code="var2 = Lua.GetReturnVal&lt;string&gt;(&quot;return UnitName('player')&quot;,0).Equals((string)Settings[&quot;FarmerName&quot;],StringComparison.InvariantCultureIgnoreCase);" />
    <!--ZoneID of bots capital city-->
    <CustomAction Code="var3 = Me.IsAlliance? 1519:1637;" />
    <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Made by HighVoltz&quot;);" />
    <!--List of zones IDs that we will farm in accending numerical order-->
    <CustomAction Code="var4 = new List&lt;uint&gt;();" />
    <!--current ZoneID-->
    <CustomAction Code="var5 = 0u;" />
    <!--Random Time-->
    <CustomAction Code="var6 = new Random().Next((int)Settings[&quot;MinMinutesPerZone&quot;],(int)Settings[&quot;MaxMinutesPerZone&quot;]);" />
    <CustomAction Code="Log( Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;I will spend {0} minutes in this zone&quot;,var6);" />
    <!--DateTime-->
    <CustomAction Code="var7 = DateTime.Now;" />
    <!--Hyjal-->
    <CustomAction Code="if ((bool)Settings[&quot;Hyjal&quot;]) ((List&lt;uint&gt;)var4).Add(616);" />
    <!--Twilight Highlands-->
    <CustomAction Code="if ((bool)Settings[&quot;Twilight&quot;]) ((List&lt;uint&gt;)var4).Add(4922);" />
    <!--Uldum-->
    <CustomAction Code="if ((bool)Settings[&quot;Uldum&quot;]) ((List&lt;uint&gt;)var4).Add(5034);" />
    <!--Deepholm-->
    <CustomAction Code="if ((bool)Settings[&quot;Deepholm&quot;]) ((List&lt;uint&gt;)var4).Add(5042);" />
    <CustomAction Code="CharacterSettings.Instance.MailRecipient = (string)Settings[&quot;BankerName&quot;];" />
    <If Condition="((List&lt;uint&gt;)var4).Count == 0" IgnoreCanRun="True">
      <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;Trying to be funny or something? How can you expect to farm anything with all zones disabled?&quot;);" />
      <CustomAction Code="TreeRoot.Stop();" />
    </If>
    <If Condition="Me.ZoneId != (int) var3 &amp;&amp; !((List&lt;uint&gt;)var4).Contains(Me.ZoneId)" IgnoreCanRun="True">
      <CustomAction Code="Log(Color.Green,&quot;MultiProfile: &quot;,Color.LightGreen,&quot;Hearthing since bot isn't in capital or one of the farmed zones&quot;);" />
      <CallSubRoutine SubRoutineName="Hearth" />
    </If>
    <If Condition="((List&lt;uint&gt;)var4).Contains(Me.ZoneId)" IgnoreCanRun="True">
      <CustomAction Code="Settings[&quot;FarmedZone&quot;] = Me.ZoneId;" />
    </If>
  </SubRoutine>
  <SubRoutine SubRoutineName="Use Portal">
    <CustomAction Code="var5 = Me.ZoneId;" />
    <!--Hyjal-->
    <If Condition="(uint)Settings[&quot;FarmedZone&quot;] == 616" IgnoreCanRun="True">
      <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Using Portal to Hyjal&quot;);" />
      <If Condition="Me.IsAlliance" IgnoreCanRun="True">
        <FlyToAction Dismount="True" X="-8212.33" Y="399.0208" Z="117.273" />
        <InteractionAction Entry="207692" InteractDelay="2000" InteractType="GameObject" GameObjectType="Transport" SpellFocus="Anvil" />
      </If>
      <If Condition="Me.IsHorde" IgnoreCanRun="True">
        <FlyToAction Dismount="True" X="2042.752" Y="-4395.662" Z="97.93639" />
        <InteractionAction Entry="207688" InteractDelay="2000" InteractType="GameObject" GameObjectType="Transport" SpellFocus="Anvil" />
      </If>
    </If>
    <!--Twilight Highlands-->
    <If Condition="(uint)Settings[&quot;FarmedZone&quot;] == 4922" IgnoreCanRun="True">
      <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Using Portal to Twilight Highlands&quot;);" />
      <If Condition="Me.IsAlliance" IgnoreCanRun="True">
        <FlyToAction Dismount="True" X="-8186.149" Y="413.7292" Z="116.7497" />
        <InteractionAction Entry="207694" InteractDelay="2000" InteractType="GameObject" GameObjectType="Transport" SpellFocus="Anvil" />
        <WaitAction Condition="Me.ZoneId != (uint) var5" Timeout="20000" />
        <MoveToAction MoveType="Location" Pathing="ClickToMove" Entry="0" X="-4879.899" Y="-6639.522" Z="10.85343" />
      </If>
      <If Condition="Me.IsHorde" IgnoreCanRun="True">
        <FlyToAction Dismount="True" X="2029.233" Y="-4379.827" Z="97.9757" />
        <InteractionAction Entry="207686" InteractDelay="2000" InteractType="GameObject" GameObjectType="Transport" SpellFocus="Anvil" />
        <WaitAction Condition="Me.ZoneId != (uint) var5" Timeout="20000" />
        <MoveToAction MoveType="Location" Pathing="ClickToMove" Entry="0" X="-4030.426" Y="-6334.861" Z="37.87898" />
      </If>
    </If>
    <!--Uldum-->
    <If Condition="(uint)Settings[&quot;FarmedZone&quot;] == 5034" IgnoreCanRun="True">
      <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Using Portal to Uldum&quot;);" />
      <If Condition="Me.IsAlliance" IgnoreCanRun="True">
        <FlyToAction Dismount="True" X="-8233.281" Y="415.5955" Z="117.4477" />
        <InteractionAction Entry="207695" InteractDelay="2000" InteractType="GameObject" GameObjectType="Transport" SpellFocus="Anvil" />
      </If>
      <If Condition="Me.IsHorde" IgnoreCanRun="True">
        <FlyToAction Dismount="True" X="2039.67" Y="-4356.288" Z="98.00434" />
        <InteractionAction Entry="207687" InteractDelay="2000" InteractType="GameObject" GameObjectType="Transport" SpellFocus="Anvil" />
      </If>
    </If>
    <!--Deepholm-->
    <If Condition="(uint)Settings[&quot;FarmedZone&quot;] == 5042" IgnoreCanRun="True">
      <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Using Portal to Deepholm&quot;);" />
      <If Condition="Me.IsAlliance" IgnoreCanRun="True">
        <FlyToAction Dismount="True" X="-8223.319" Y="451.1823" Z="117.4883" />
        <InteractionAction Entry="207693" InteractDelay="2000" InteractType="GameObject" GameObjectType="Transport" SpellFocus="Anvil" />
      </If>
      <If Condition="Me.IsHorde" IgnoreCanRun="True">
        <FlyToAction Dismount="True" X="2065.653" Y="-4390.647" Z="98.04689" />
        <InteractionAction Entry="207689" InteractDelay="2000" InteractType="GameObject" GameObjectType="Transport" SpellFocus="Anvil" />
      </If>
      <WaitAction Condition="Me.ZoneId != (uint) var5" Timeout="20000" />
      <FlyToAction Dismount="False" X="998.0914" Y="521.6063" Z="-49.33473" />
      <FlyToAction Dismount="False" X="856.4835" Y="494.8993" Z="-63.27364" />
    </If>
    <!--Wait until zone changes.-->
    <WaitAction Condition="Me.ZoneId != (uint) var5" Timeout="20000" />
  </SubRoutine>
  <SubRoutine SubRoutineName="DepositGoldInGbank">
    <CallSubRoutine SubRoutineName="MoveToGbank" />
    <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Depositing all but {0} gold into GBank&quot;,Settings[&quot;DepositAllButThisAmountInGBank&quot;]);" />
    <InteractionAction Entry="0" InteractDelay="2000" InteractType="GameObject" GameObjectType="GuildBank" SpellFocus="Anvil" />
    <WaitAction Condition="false" Timeout="2000" />
    <!--Deposit gold in Gbank-->
    <CustomAction Code="Lua.DoString(&quot;local goldToKeep={0}*10000 local depositAmount=(GetMoney()-goldToKeep) if depositAmount &gt; 0 then DepositGuildBankMoney(depositAmount) end&quot;,Settings[&quot;DepositAllButThisAmountInGBank&quot;]);" />
  </SubRoutine>
  <SubRoutine SubRoutineName="MoveToGbank">
    <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Move to nearest GBank&quot;);" />
    <If Condition="Me.MapId == 0" IgnoreCanRun="True">
      <!--Stormwind-->
      <If Condition="Me.ZoneId == 1519" IgnoreCanRun="True">
        <!--Stormwind 'Human' GuildBank-->
        <If Condition="DistanceTo(-8920.106, 621.256, 100.226) &lt; DistanceTo(-8315.161, 582.8967, 100.3132)" IgnoreCanRun="True">
          <MoveToAction MoveType="Location" Pathing="Navigator" Entry="0" X="-8920.106" Y="621.256" Z="100.226" />
        </If>
        <!--Stormwind 'Dwarf' GuildBank-->
        <If Condition="DistanceTo(-8920.106, 621.256, 100.226) &gt;= DistanceTo(-8315.161, 582.8967, 100.3132)" IgnoreCanRun="True">
          <MoveToAction MoveType="Location" Pathing="Navigator" Entry="0" X="-8315.161" Y="582.8967" Z="100.3132" />
        </If>
      </If>
    </If>
    <If Condition="Me.MapId == 1" IgnoreCanRun="True">
      <!--Org-->
      <If Condition="Me.ZoneId == 1637" IgnoreCanRun="True">
        <!--Valley of Strength GuildBank-->
        <If Condition="DistanceTo(1533.167, -4362.145, 20.54772) &lt; DistanceTo(1886.409, -4683.326, 38.5004)" IgnoreCanRun="True">
          <MoveToAction MoveType="Location" Pathing="Navigator" Entry="0" X="1533.167" Y="-4362.145" Z="20.54772" />
        </If>
        <!--Valley of Honor GuildBank-->
        <If Condition="DistanceTo(1533.167, -4362.145, 20.54772) &gt;= DistanceTo(-1886.409, -4683.326, 38.5004)" IgnoreCanRun="True">
          <MoveToAction MoveType="Location" Pathing="Navigator" Entry="0" X="1886.409" Y="-4683.326" Z="38.5004" />
        </If>
      </If>
    </If>
    <!--Dalaran-->
    <If Condition="Me.ZoneId == 4395" IgnoreCanRun="True">
      <!--North GuildBank-->
      <If Condition="DistanceTo(5961.328, 616.5127, 650.6276) &lt; DistanceTo(5651.325, 682.1651, 651.9932)" IgnoreCanRun="True">
        <MoveToAction MoveType="Location" Pathing="Navigator" Entry="0" X="5961.328" Y="616.5127" Z="650.6276" />
      </If>
      <!--Valley of Honor GuildBank-->
      <If Condition="DistanceTo(5961.328, 616.5127, 650.6276) &gt;= DistanceTo(5651.325, 682.1651, 651.9932)" IgnoreCanRun="True">
        <MoveToAction MoveType="Location" Pathing="Navigator" Entry="0" X="5651.325" Y="682.1651" Z="651.9932" />
      </If>
    </If>
  </SubRoutine>
  <SubRoutine SubRoutineName="LoadProfile">
    <!--Hyjal-->
    <If Condition="(uint)Settings[&quot;FarmedZone&quot;] == 616" IgnoreCanRun="True">
      <If Condition="Bots.Gatherbuddy.GatherbuddySettings.Instance.GatherHerbs" IgnoreCanRun="True">
        <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Herb&amp;Mining profile for Hyjal&quot;);" />
        <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(Hyjal.Nuetral)Mines&amp;Herbs.xml" ProfileType="Honorbuddy" />
      </If>
      <!--if herb gathering is off in GB2 load a mine only profile.-->
      <If Condition="!Bots.Gatherbuddy.GatherbuddySettings.Instance.GatherHerbs" IgnoreCanRun="True">
        <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Mining profile for Hyjal&quot;);" />
        <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(Hyjal.Nuetral)Mines.xml" ProfileType="Honorbuddy" />
      </If>
    </If>
    <!--Twilight Highlands-->
    <If Condition="(uint)Settings[&quot;FarmedZone&quot;] == 4922" IgnoreCanRun="True">
      <If Condition="Me.IsAlliance" IgnoreCanRun="True">
        <If Condition="Bots.Gatherbuddy.GatherbuddySettings.Instance.GatherHerbs" IgnoreCanRun="True">
          <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Alliance Herb&amp;Mining profile for Twilight Highlands&quot;);" />
          <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(TwilightHighlands.Alliance)Herb&amp;Mines.xml" ProfileType="Honorbuddy" />
        </If>
        <!--if herb gathering is off in GB2 load a mine only profile.-->
        <If Condition="!Bots.Gatherbuddy.GatherbuddySettings.Instance.GatherHerbs" IgnoreCanRun="True">
          <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Alliance Mining profile for Twilight Highlands&quot;);" />
          <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(TwilightHighlands.Alliance)Mines.xml" ProfileType="Honorbuddy" />
        </If>
      </If>
      <If Condition="Me.IsHorde" IgnoreCanRun="True">
        <If Condition="Bots.Gatherbuddy.GatherbuddySettings.Instance.GatherHerbs" IgnoreCanRun="True">
          <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Horde Herb&amp;Mining profile for Twilight Highlands&quot;);" />
          <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(TwilightHighlands.Horde)Herb&amp;mines.xml" ProfileType="Honorbuddy" />
        </If>
        <!--if herb gathering is off in GB2 load a mine only profile.-->
        <If Condition="!Bots.Gatherbuddy.GatherbuddySettings.Instance.GatherHerbs" IgnoreCanRun="True">
          <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Horde Mining profile for Twilight Highlands&quot;);" />
          <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(TwilightHighlands.Horde)Mines.xml" ProfileType="Honorbuddy" />
        </If>
      </If>
    </If>
    <!--Uldum-->
    <If Condition="(uint)Settings[&quot;FarmedZone&quot;] == 5034" IgnoreCanRun="True">
      <If Condition="Bots.Gatherbuddy.GatherbuddySettings.Instance.GatherHerbs" IgnoreCanRun="True">
        <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Herb&amp;Mining profile for Uldum&quot;);" />
        <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(Uldum.Nuetral)Mines&amp;Herbs.xml" ProfileType="Honorbuddy" />
      </If>
      <!--if herb gathering is off in GB2 load a mine only profile.-->
      <If Condition="!Bots.Gatherbuddy.GatherbuddySettings.Instance.GatherHerbs" IgnoreCanRun="True">
        <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Mining profile for Uldum&quot;);" />
        <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(Uldum.Nuetral)Mines.xml" ProfileType="Honorbuddy" />
      </If>
    </If>
    <!--Deepholm-->
    <If Condition="(uint)Settings[&quot;FarmedZone&quot;] == 5042" IgnoreCanRun="True">
      <CustomAction Code="Log(Color.Green,&quot;Multiprofile: &quot;,Color.LightGreen,&quot;Loading Herb&amp;Mining profile for Deepholm&quot;);" />
      <LoadProfileAction Path="HBProfiles\GatheringProfiles\(GB2)(Deepholm.Nuetral)Herb&amp;Mines.xml" ProfileType="Honorbuddy" />
    </If>
  </SubRoutine>
</Professionbuddy>